<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">
  <link rel="icon" href="favicon.ico">

  <title>ProfEd NRMS</title>
  <link href="css/bootstrap.css" rel="stylesheet">
  <link href="css/dashboard.css" rel="stylesheet">
  <link href="css/bootstrap-slider.min.css" rel="stylesheet">
</head>

<body>
  <nav class="navbar navbar-dark fixed-top bg-primary flex-md-nowrap p-0 shadow">
    <a class="navbar-brand col-12" href="#">Aeroacoustics: Noise Reduction Strategies for Mechanical Systems</a>
  </nav>

  <div class="container-fluid">
    <div class="row">
      <nav class="col-md-2 d-none d-md-block bg-light sidebar">
        <div class="sidebar-sticky">
          <ul class="nav flex-column">

            <li class="nav-item">
              <a class="nav-link"   href="index.html" target="_self">
		<span data-feather="file"></span>
                Jet noise - Lighthill's analogy
              </a>
            </li>

            <li class="nav-item">
              <a class="nav-link "  href="WindTurbine1.html"  target="_self">
                <span data-feather="file"></span>
                Wind turbine noise - surface pressure fluctuations 
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link "  href="WindTurbine2.html"  target="_self">
                <span data-feather="file"></span>
                Wind turbine noise - predicted noise in the far field
              </a>
            </li>

            <li class="nav-item">
              <a class="nav-link active"  href="Propeller.html"  target="_self">
                <span data-feather="file"></span>
                Propeller noise - tonal components
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link"  href="WingFlap.html"  target="_self">
                <span data-feather="file"></span>
                Cavity noise - frequency response
              </a>
            </li>

          </ul>
        </div>
      </nav>

      <main role="main" class="col-md-9 ml-sm-auto col-lg-10 px-4">
        <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
          <h1 class="h2">Propeller noise - tonal components</h1>
          <div class="btn-toolbar mb-2 mb-md-0">
            <div class="btn-group mr-2">
              <button class="btn btn-sm btn-outline-secondary active" onclick="caseAction(this)">Case 1: Spectrum in frequency</button>
              <button class="btn btn-sm btn-outline-secondary" onclick="caseAction(this)">Case 2: Directivity
              </button>
              <button class="btn btn-sm btn-outline-secondary" onclick="caseAction(this)">Case 3: Mach Number
              </button>
            </div>
          </div>
        </div>

        <blockquote class="blockquote text-justify">
          <p><font size="3">The most important noise contribution from a propeller is the tonal one derived from the thickness and loading distributions of the blade. 
		  	    As you have studied, the propeller blade rotation displaces the blade geometry in the flow. From the flow viewpoint at every instant of time, the perturbation 
		  	    of the blade moving is felt as a local flow ejection (i.e. the flow is displaced by the blade movement) and as a varying force in space (i.e. the blade loading).
		  	    These two contributions determine tonal noise component since they are associated to the blade rotational frequency. Additional broadband components are determined 
		  	    by the blade wakes; however, they are generally less loud than the first. In the following graph we have superimposed the tonal contribution from the simple one 
		  	    equation model from xxx to the broadband contributions as computed from the trailing-edge noise theory. As you can see, the values of the first BPFs are way louder
		  	    than all other contributions at higher BPF. Formulas and data are taken from:
 	  </p>
          <p><font size="3"; style="color:blue"> Magliozzi B., Hanson D.B., Amiet R.K., 1991, Propeller and Propfan Noise, in Aeroacoustics of Flying Vehicles, NASA Reference Publication 1258 Vo.1 WRDC T.R.90-3052. 
          </p>	  				
        </blockquote>
        <div class="row">
          <div class="col"><img style="width:660px;height:110px" src="img/propeller/formula.png" alt=""></div>
          <div class="col">
            <img style="width:180px;height:70px" src="img/click.png" alt="" data-toggle="modal" data-target="#exampleModal">
          </div>
        </div>

        <div class="row" style="margin-top:30px;">
          <div class="col">
            <h4 id="caseTitle" class="text-primary">Case 1: Spectrum in frequency</h4>
          </div>

        </div>
        <div class="row" style="margin-bottom:30px;">
          <div class="col-12">
            <h6 id="caseDesc">A Twin Otter, four-bladed propeller with D=0.21m is considered in static conditions, the observer is located in the propeller disk plane at a distance of 6D, the blade is rotating at 180 Hz.</h6>
          </div>
        </div>

        <div id="container" style="width: 60% margin: 0 auto"></div>

        <div id="sliderCase1Area">
          <div class="row">
            <div class="col-1">&nbsp;</div>
            <div class="col-11">
              <input id="sliderCase11" type="text" style="width:90%;padding-left: 100px;" data-slider-min="-1"
                data-slider-max="8" data-slider-step="1" data-slider-value="-1" />
            </div>
          </div>
        </div>

        <div id="sliderCase2Area" style="display:none">
          <div class="row">
            <div class="col-1">Directivity, 0°
            </div>
            <div class="col-11">
              <input id="sliderCase21" type="text" style="width:90%;padding-left: 100px;" data-slider-min="-1"
                data-slider-max="3" data-slider-step="1" data-slider-value="-1" />
            </div>
          </div>

          <div class="row">
            <div class="col-1">Directivity, 90°
            </div>
            <div class="col-11">
              <input id="sliderCase22" type="text" style="width:90%;padding-left: 100px;" data-slider-min="-1"
                data-slider-max="3" data-slider-step="1" data-slider-value="-1" />
            </div>
          </div>

        </div>

        <div id="sliderCase3Area" style="display:none">
          <div class="row">
            <div class="col-1">Relative Mach at the tip, Mt=0.77
            </div>
            <div class="col-11">
              <input id="sliderCase31" type="text" style="width:90%;padding-left: 100px;" data-slider-min="-1"
                data-slider-max="9" data-slider-step="1" data-slider-value="-1" />
            </div>
          </div>

          <div class="row">
            <div class="col-1">Relative Mach at the tip, Mt=0.87
            </div>
            <div class="col-11">
              <input id="sliderCase32" type="text" style="width:90%;padding-left: 100px;" data-slider-min="-1"
                data-slider-max="9" data-slider-step="1" data-slider-value="-1" />
            </div>
          </div>

        </div>

    </div>

    </main>
  </div>
  </div>


  <!-- Modal -->
  <div class="modal fade" style="top:100px;left:-200px;" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
    aria-hidden="true">
    <div class="modal-dialog" role="document">
      <img style="width:800px;height:600px" src="img/propeller/explain.png" alt="">
    </div>
  </div>

  <script src="js/jquery.min.js"></script>
  <script src="js/popper.min.js"></script>
  <script src="js/bootstrap.min.js"></script>

  <script src="js/bootstrap-slider.js"></script>
  <script src="https://code.highcharts.com/highcharts.js"></script>
  <script src="https://code.highcharts.com/modules/exporting.js"></script>

  <!-- icons -->
  <script src="https://unpkg.com/feather-icons/dist/feather.min.js"></script>
  <script>
    feather.replace();
  </script>
  <!-- icons end -->

  <script>
    var sidebtn = function (nav) {
      console.log($(nav));
      // let navTitle = $(nav).text().trim();
      // if('Wind Turbine' === navTitle){
      //   $(nav).
      // }
    }
  </script>

  <script>
    let cases = [{title: 'Case 1: Spectrum in frequency',
        	  desc: 'A Twin Otter, four-bladed propeller with D=0.21m is considered in static conditions, the observer is located in the propeller disk plane at a distance of 6D, the blade is rotating at 180 Hz.'},
    		 {title: 'Case 2: Directivity',
                  desc: 'A Twin Otter, four-bladed propeller with D=0.21m is considered in static conditions, the observer is located in the propeller disk plane at a distance of 10D at an angle of 90° with respect to the propeller axis, and upstream of it 0°, respectively. The propeller rotatates at 230Hz.'},
      		 {title: 'Case 3: Mach Number',
        	  desc: 'A Twin Otter, four-bladed propeller with D=0.21m is considered in static conditions, the observer is located in the propeller disk plane at a distance of 10D at an angle of 90°. The blade tip Mach number is varied between 0.77 and 0.83 by changing the rotational frequency.'}]
    let case11Data = [
      [1,55],
			[2,41],
			[3,39],
			[4,43],
			[5,39],
			[6,40],
			[7,41],
			[8,38],
			[9,36]
    ];
    let case21Data = [
      [1,117],
			[2,99],
			[3,87],
			[4,88]
    ];
    let case22Data = [
      [1,120],
			[2,90],
			[3,95],
			[4,85]
    ];
    let case31Data = [
      [1,103],
			[2, 100],
			[3, 95],
			[4, 88],
			[5, 82],
			[6, 76],
			[7, 69],
			[8, 65],
			[9, 62],
			[10, 60]
    ];
    let case32Data = [
      [1,109],
			[2,106],
			[3,103],
			[4,98],
			[5,93],
			[6,88],
			[7,83],
			[8,78],
			[9,73],
			[10,71]
    ];



  </script>

  <!--  case 按钮切换 -->
  <script>
    function caseAction(caseBtn) {
      console.log('case', $(caseBtn).text());
      let btnText = $(caseBtn).text().trim();

      if (cases[0].title === btnText) {


        $('.btn-outline-secondary').removeClass('active');
        $('.btn-outline-secondary').eq(0).addClass('active');
        $('#caseTitle').text(cases[0].title);
        $('#caseDesc').text(cases[0].desc);
        $('#sliderCase1Area').show();
        $('#sliderCase2Area').hide();
        $('#sliderCase3Area').hide();
        //设置hightcharts
        var chart_length = chart.series.length;
        for(var i=0;i<chart_length;i++)
        {
          chart.series[0].remove();
        }

        chart.addSeries({
          data: [],
          name: 'Frequency',
          showInLegend: false,
          color: 'rgba(223, 83, 83, .5)',
          marker:{symbol:'circle',fillColor:'red'},
        });


        chart.yAxis[0].update({
          max: 60,
          min: 20
        });
        chart.xAxis[0].update({
          max: 10,
          min: 0
        });

        $("#sliderCase11").slider('refresh');

      }else if ( cases[1].title=== btnText) {

        var chart_length = chart.series.length;
        for(var i=0;i<chart_length;i++)
        {
          chart.series[0].remove();
        }

        chart.addSeries({
          data: [],
          name: 'Directivity: 0° (upstream)',
          color: 'rgba(223, 83, 83, .5)',
        });

        chart.addSeries({
          data: [],
          name: 'Directivity: 90° (propeller plane)',
          color: '#70C1B3',
        });


        $('.btn-outline-secondary').removeClass('active');
        $('.btn-outline-secondary').eq(1).addClass('active');
        $('#caseTitle').text(cases[1].title);
        $('#caseDesc').text(cases[1].desc);
        $('#sliderCase1Area').hide();
        $('#sliderCase2Area').show();
        $('#sliderCase3Area').hide();
        // $('#sliderCase21').silder({value:0});

        chart.yAxis[0].update({
          max: 118,
          min: 84
        });
        chart.xAxis[0].update({
          max: 5,
          min: 0
        });

        $("#sliderCase21").slider('refresh');
        $("#sliderCase22").slider('refresh');

      }else if ( cases[2].title=== btnText) {


        var chart_length = chart.series.length;
        for(var i=0;i<chart_length;i++)
        {
          chart.series[0].remove();
        }

        chart.addSeries({
          data: [],
          name: 'Mt=0.77',
          color: 'rgba(223, 83, 83, .5)',
        });

        chart.addSeries({
          data: [],
          name: 'Mt=0.83',
          color: '#70C1B3',
        });


        $('.btn-outline-secondary').removeClass('active');
        $('.btn-outline-secondary').eq(2).addClass('active');
        $('#caseTitle').text(cases[2].title);
        $('#caseDesc').text(cases[2].desc);
        $('#sliderCase1Area').hide();
        $('#sliderCase2Area').hide();
        $('#sliderCase3Area').show();
        // $('#sliderCase21').silder({value:0});

        chart.yAxis[0].update({
          max: 110,
          min: 50
        });
        chart.xAxis[0].update({
          max: 10,
          min: 0
        });

        $("#sliderCase31").slider('refresh');
        $("#sliderCase32").slider('refresh');

      }


    }
  </script>



  <!-- 滚动条事件 -->
  <script>
    let data11 = [],
      data21 = [],
      data22 = [],
      data31 =[],
      data32=[];
    $("#sliderCase11").slider();
    $("#sliderCase21").slider();
    $("#sliderCase22").slider();
    $("#sliderCase31").slider();
    $("#sliderCase32").slider();

    $("#sliderCase11").on("slide", function (slideEvt) {
      if (-1 === slideEvt.value) {
        data = [];
        chart.series[0].setData(data);
      }

      else
      {
        data=[];
        for(var i=0;i<=slideEvt.value;i++)
        data.push(case11Data[i]);

        chart.series[0].setData(data);
      }
    });

    $("#sliderCase21").on("slide", function (slideEvt) {
      // console.log('sliderCase21', slideEvt.value)
      if (-1 === slideEvt.value) {
        data = [];
        chart.series[0].setData(data);
      }

      else
      {
        data=[];
        for(var i=0;i<=slideEvt.value;i++)
        data.push(case21Data[i]);

        chart.series[0].setData(data);
      }
    });

    $("#sliderCase22").on("slide", function (slideEvt) {
      if (-1 === slideEvt.value) {
        data = [];
        chart.series[1].setData(data);
      }

      else
      {
        data=[];
        for(var i=0;i<=slideEvt.value;i++)
        data.push(case22Data[i]);

        chart.series[1].setData(data);
      }
    });

    $("#sliderCase31").on("slide", function (slideEvt) {
      if (-1 === slideEvt.value) {
        data = [];
        chart.series[0].setData(data);
      }

      else
      {
        data=[];
        for(var i=0;i<=slideEvt.value;i++)
        data.push(case31Data[i]);

        chart.series[0].setData(data);
      }
    });


    $("#sliderCase32").on("slide", function (slideEvt) {
      if (-1 === slideEvt.value) {
        data = [];
        chart.series[1].setData(data);
      }

      else
      {
        data=[];
        for(var i=0;i<=slideEvt.value;i++)
        data.push(case32Data[i]);

        chart.series[1].setData(data);
      }
    });


  </script>

  <!-- highcharts -->
  <script>
    Highcharts.setOptions({
      colors: ['#70C1B3', '#247BA0', '#F3FFBD', '#B2DBBF']
    });
    var chart = Highcharts.chart('container', {
	  credits: {
        enabled: false
      }, //去掉版权
      chart: {
        type: 'column',
        zoomType: 'xy'
      },
      title: {
        text: ' '
      },
      subtitle: {
        text: ' '
      },
      xAxis: {
        title: {
          enabled: true,
          text: 'BPF Harmonics'
        },
        // startOnTick: true,
        // endOnTick: true,
        showLastLabel: true,
        max: 10,
        min: 1
      },
      yAxis: {
        title: {
          text: 'SPL(dB)'
        },
        max: 60,
        min: 20
      },
      legend: {
        layout: 'vertical',
        align: 'left',
        verticalAlign: 'top',
        x: 100,
        y: 10,
        floating: true,
        // backgroundColor: (Highcharts.theme && Highcharts.theme.legendBackgroundColor) || '#FFFFFF',
        borderWidth: 1
      },
      tooltip: {
        headerFormat: 'BPF harmonic: {point.x}<br/>',
        pointFormat: 'SPL (dB): {point.y}<br/>'
    },
      series: [{
        name: 'Frequency',
        color: 'rgba(223, 83, 83, .5)',
        showInLegend: false,
        data: []
      }
      ]
    });
  </script>

</body>

</html>
